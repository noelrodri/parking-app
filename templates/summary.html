
{% if user.has_role('admin') %}
	
	{% extends "admin_dash.html" %}
	
{% else %}

	{% extends "user_dash.html" %}

{% endif %}

{% block title %}
Summary
{% endblock %}



{% block content %}

{% if user.has_role('admin') %}
    <script>
        window.chartData = {
            revenue_labels: {{ revenue_labels | tojson }},
            revenue_values: {{ revenue_values | tojson }},
            lot_labels : {{ lot_labels | tojson }}, 
            available_counts : {{ available_counts | tojson }},
            occupied_counts : {{ occupied_counts | tojson }}
        };   
    </script>

    {% if revenue_values or available_counts or occupied_counts %}
        <div class="container my-4">
            {% if revenue_values %}
                <h2 class="text-center mb-4">Revenue from each spot</h2>
                <div class="card shadow rounded mb-5">
                    <div class="card-body d-flex justify-content-center">
                        <canvas id="revenueChart" style="max-width: 400px; max-height: 300px;"></canvas>
                    </div>
                </div>
            {% endif %}

            {% if available_counts or occupied_counts %}
                <h2 class="text-center mb-4">Occupancy per parking lot</h2>
                <div class="card shadow rounded">
                    <div class="card-body" style="height: 320px;">
                        <canvas id="occupancyChart" style="max-height: 100%; max-width: 100%;"></canvas>
                    </div>
                </div>
            {% endif %}
        </div>
    {% else %}
        <div class="container my-4">
            <h2 class="text-center text-dark fw-bold text-capitalize">No Data to Display</h2>
        </div>
    {% endif %}




{% else %}
    <script>
        window.chartData = {
            labels: {{ labels | tojson }},
            values: {{ values | tojson }},
            maxvalue: {{ max_value | tojson }}
        };
    </script>

    {% if labels %}
        <div class="container my-4">
            <h2 class="text-center mb-4">Parking Spot Usage</h2>
                <div class="row justify-content-center">
                    <div class="col-md-12">
                        <div class="card shadow rounded">
                            <div class="card-body">
                                <div style="overflow-x: auto;">
                                    <canvas id="usageChart"></canvas>
                                  </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

    {% else %}
        <div class="container my-4">
            <h2 class = "text-center text-dark fw-bold text-capitalize">No Data to Display</h2>
        </div>   

    {% endif %}



{% endif %}

{% endblock %}